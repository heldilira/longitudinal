[
  {
    "objectID": "posts/Matrizes-cov.html",
    "href": "posts/Matrizes-cov.html",
    "title": "Matrizes-cov",
    "section": "",
    "text": "library(nlme)\nlibrary(ggplot2)\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ lubridate 1.9.4     ✔ tibble    3.2.1\n✔ purrr     1.0.4     ✔ tidyr     1.3.1\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::collapse() masks nlme::collapse()\n✖ dplyr::filter()   masks stats::filter()\n✖ dplyr::lag()      masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\n\n\n# dat &lt;- readxl::read_excel(\"P1_diary_COMPLETO.xlsx\") |&gt; \n#      janitor::clean_names() |&gt; \n#      dplyr::filter(!is.na(sleep_satisfaction))\n\ndat &lt;- read.csv(\"data/mydata.csv\") |&gt; \n     dplyr::mutate(randomization = factor(randomization)) |&gt; \n     dplyr::filter(!is.na(insomnia_severity))\n\nhead(dat)\n\n  record_id redcap_event_name randomization  age sex ethnicity marital_status\n1         3                 1             1 35.0   2         1              3\n2         3                 2             1 35.0   2         1              3\n3         3                 3             1 35.0   2         1              3\n4        10                 1             3 44.3   1         1              5\n5        10                 2             3 44.3   1         1              5\n6        10                 3             3 44.3   1         1              5\n  child_n education weight height medication_weekly insomnia_severity\n1      NA         9    120   1.72                 0                21\n2      NA         9    120   1.72                 0                10\n3      NA         9    120   1.72                 0                12\n4       2         9     65   1.73                 3                12\n5       2         9     65   1.73                 3                 9\n6       2         9     65   1.73                 3                13\n  depression anxiety\n1         11      10\n2          6      10\n3          4       9\n4          5       5\n5          3       6\n6          2       3\n\n\n\ndat |&gt; \n     ggplot(aes(x = redcap_event_name, y = insomnia_severity, \n                group = record_id, color = randomization)) +\n     geom_point() +\n     geom_line() +\n     #geom_smooth(method = 'lm') +\n     theme_minimal()\n\n\n\n\n\n\n\n\n\n# Compound symmetry\nm1 &lt;- gls(insomnia_severity ~ redcap_event_name, corr = corCompSymm(form = ~1|record_id), method=\"ML\", data=dat)\nsummary(m1) # get the fixed effects parameters and fit indices\n\nGeneralized least squares fit by maximum likelihood\n  Model: insomnia_severity ~ redcap_event_name \n  Data: dat \n      AIC      BIC   logLik\n  3755.24 3772.939 -1873.62\n\nCorrelation Structure: Compound symmetry\n Formula: ~1 | record_id \n Parameter estimate(s):\n      Rho \n0.4655808 \n\nCoefficients:\n                      Value Std.Error   t-value p-value\n(Intercept)       21.916783 0.4896754  44.75778       0\nredcap_event_name -3.615349 0.2025457 -17.84955       0\n\n Correlation: \n                  (Intr)\nredcap_event_name -0.786\n\nStandardized residuals:\n        Min          Q1         Med          Q3         Max \n-2.65247966 -0.66575030 -0.05444256  0.66800448  3.05762421 \n\nResidual standard error: 5.536738 \nDegrees of freedom: 617 total; 615 residual\n\n\n\ngetVarCov(m1) # get the random effects parameters\n\nMarginal variance covariance matrix\n       [,1]   [,2]   [,3]\n[1,] 30.655 14.273 14.273\n[2,] 14.273 30.655 14.273\n[3,] 14.273 14.273 30.655\n  Standard Deviations: 5.5367 5.5367 5.5367 \n\ncov2cor(getVarCov(m1))\n\nMarginal variance covariance matrix\n        [,1]    [,2]    [,3]\n[1,] 1.00000 0.46558 0.46558\n[2,] 0.46558 1.00000 0.46558\n[3,] 0.46558 0.46558 1.00000\n  Standard Deviations: 1 1 1 \n\n\n\n# AR1 pattern\nm2 &lt;- gls(insomnia_severity ~ redcap_event_name, corr = corAR1(form = ~1|record_id), method=\"ML\", data=dat)\nsummary(m2)\n\nGeneralized least squares fit by maximum likelihood\n  Model: insomnia_severity ~ redcap_event_name \n  Data: dat \n      AIC      BIC   logLik\n  3774.84 3792.539 -1883.42\n\nCorrelation Structure: AR(1)\n Formula: ~1 | record_id \n Parameter estimate(s):\n      Phi \n0.4519796 \n\nCoefficients:\n                      Value Std.Error   t-value p-value\n(Intercept)       22.286727 0.5447656  40.91067       0\nredcap_event_name -3.624387 0.2429853 -14.91608       0\n\n Correlation: \n                  (Intr)\nredcap_event_name -0.852\n\nStandardized residuals:\n       Min         Q1        Med         Q3        Max \n-2.7312258 -0.7333820 -0.1202957  0.6061930  3.0124639 \n\nResidual standard error: 5.505936 \nDegrees of freedom: 617 total; 615 residual\n\n\n\ngetVarCov(m2)\n\nMarginal variance covariance matrix\n       [,1]   [,2]   [,3]\n[1,] 30.315 13.702  6.193\n[2,] 13.702 30.315 13.702\n[3,]  6.193 13.702 30.315\n  Standard Deviations: 5.5059 5.5059 5.5059 \n\ncov2cor(getVarCov(m2))\n\nMarginal variance covariance matrix\n        [,1]    [,2]    [,3]\n[1,] 1.00000 0.45198 0.20429\n[2,] 0.45198 1.00000 0.45198\n[3,] 0.20429 0.45198 1.00000\n  Standard Deviations: 1 1 1 \n\n\n\nanova(m1, m2)\n\n   Model df     AIC      BIC   logLik\nm1     1  4 3755.24 3772.939 -1873.62\nm2     2  4 3774.84 3792.539 -1883.42\n\n\n\n# CS with heterogeneous variances\nm3 &lt;- gls(insomnia_severity ~ redcap_event_name, corr = corCompSymm(form = ~1|record_id), weights = varIdent(form = ~ 1 | redcap_event_name),\n          method=\"ML\",data=dat)\nsummary(m3)\n\nGeneralized least squares fit by maximum likelihood\n  Model: insomnia_severity ~ redcap_event_name \n  Data: dat \n       AIC      BIC    logLik\n  3708.884 3735.433 -1848.442\n\nCorrelation Structure: Compound symmetry\n Formula: ~1 | record_id \n Parameter estimate(s):\n      Rho \n0.4926884 \nVariance function:\n Structure: Different standard deviations per stratum\n Formula: ~1 | redcap_event_name \n Parameter estimates:\n       1        2        3 \n1.000000 1.569090 1.432951 \n\nCoefficients:\n                     Value Std.Error   t-value p-value\n(Intercept)       22.93222 0.3685687  62.21966       0\nredcap_event_name -3.77321 0.1903386 -19.82368       0\n\n Correlation: \n                  (Intr)\nredcap_event_name -0.683\n\nStandardized residuals:\n       Min         Q1        Med         Q3        Max \n-2.6811859 -0.8247143 -0.2122039  0.5679865  2.7477694 \n\nResidual standard error: 4.161967 \nDegrees of freedom: 617 total; 615 residual\n\n\n\ngetVarCov(m3)\n\nMarginal variance covariance matrix\n       [,1]   [,2]   [,3]\n[1,] 17.322 13.391 12.229\n[2,] 13.391 42.647 19.189\n[3,] 12.229 19.189 35.568\n  Standard Deviations: 4.162 6.5305 5.9639 \n\ncov2cor(getVarCov(m3))\n\nMarginal variance covariance matrix\n        [,1]    [,2]    [,3]\n[1,] 1.00000 0.49269 0.49269\n[2,] 0.49269 1.00000 0.49269\n[3,] 0.49269 0.49269 1.00000\n  Standard Deviations: 1 1 1 \n\n\n\nanova(m1, m2, m3)\n\n   Model df      AIC      BIC    logLik   Test  L.Ratio p-value\nm1     1  4 3755.240 3772.939 -1873.620                        \nm2     2  4 3774.840 3792.539 -1883.420                        \nm3     3  6 3708.884 3735.433 -1848.442 2 vs 3 69.95528  &lt;.0001\n\n# podemos interpretar o teste de significancia?\n# o que significa o teste da anova neste caso?\n\n\n# AR1 with heterogeneous variances\nm4 &lt;- gls(insomnia_severity ~ redcap_event_name, corr = corAR1(form = ~1|record_id), weights = varIdent(form = ~ 1 | redcap_event_name),\n          method=\"ML\",data=dat)\nsummary(m4)\n\nGeneralized least squares fit by maximum likelihood\n  Model: insomnia_severity ~ redcap_event_name \n  Data: dat \n       AIC      BIC    logLik\n  3729.156 3755.705 -1858.578\n\nCorrelation Structure: AR(1)\n Formula: ~1 | record_id \n Parameter estimate(s):\n      Phi \n0.5230382 \nVariance function:\n Structure: Different standard deviations per stratum\n Formula: ~1 | redcap_event_name \n Parameter estimates:\n       1        2        3 \n1.000000 1.597656 1.388839 \n\nCoefficients:\n                      Value Std.Error   t-value p-value\n(Intercept)       23.330537 0.4177018  55.85453       0\nredcap_event_name -3.737049 0.2207465 -16.92914       0\n\n Correlation: \n                  (Intr)\nredcap_event_name -0.787\n\nStandardized residuals:\n       Min         Q1        Med         Q3        Max \n-2.7425440 -0.8719788 -0.2748762  0.4906503  2.7049227 \n\nResidual standard error: 4.227275 \nDegrees of freedom: 617 total; 615 residual\n\n\n\ngetVarCov(m4)\n\nMarginal variance covariance matrix\n        [,1]   [,2]    [,3]\n[1,] 17.8700 14.933  6.7895\n[2,] 14.9330 45.613 20.7390\n[3,]  6.7895 20.739 34.4690\n  Standard Deviations: 4.2273 6.7537 5.871 \n\ncov2cor(getVarCov(m4))\n\nMarginal variance covariance matrix\n        [,1]    [,2]    [,3]\n[1,] 1.00000 0.52304 0.27357\n[2,] 0.52304 1.00000 0.52304\n[3,] 0.27357 0.52304 1.00000\n  Standard Deviations: 1 1 1 \n\n\n\nanova(m1, m2, m3, m4)\n\n   Model df      AIC      BIC    logLik   Test  L.Ratio p-value\nm1     1  4 3755.240 3772.939 -1873.620                        \nm2     2  4 3774.840 3792.539 -1883.420                        \nm3     3  6 3708.884 3735.433 -1848.442 2 vs 3 69.95528  &lt;.0001\nm4     4  6 3729.156 3755.705 -1858.578                        \n\n\n\n# Unstructured\nm5 &lt;- gls(insomnia_severity ~ redcap_event_name, corr = corSymm(form = ~1|record_id), weights = varIdent(form = ~ 1 | redcap_event_name), \n          method=\"ML\",data=dat)\nsummary(m5)\n\nGeneralized least squares fit by maximum likelihood\n  Model: insomnia_severity ~ redcap_event_name \n  Data: dat \n      AIC      BIC    logLik\n  3675.31 3710.709 -1829.655\n\nCorrelation Structure: General\n Formula: ~1 | record_id \n Parameter estimate(s):\n Correlation: \n  1     2    \n2 0.263      \n3 0.468 0.707\nVariance function:\n Structure: Different standard deviations per stratum\n Formula: ~1 | redcap_event_name \n Parameter estimates:\n       1        2        3 \n1.000000 1.603832 1.470056 \n\nCoefficients:\n                      Value Std.Error   t-value p-value\n(Intercept)       21.386583 0.3371379  63.43572       0\nredcap_event_name -2.873798 0.1841657 -15.60441       0\n\n Correlation: \n                  (Intr)\nredcap_event_name -0.636\n\nStandardized residuals:\n       Min         Q1        Med         Q3        Max \n-2.5349591 -0.8470415 -0.1236483  0.5306013  2.4989431 \n\nResidual standard error: 4.147122 \nDegrees of freedom: 617 total; 615 residual\n\n\n\ngetVarCov(m5)\n\nMarginal variance covariance matrix\n        [,1]    [,2]   [,3]\n[1,] 17.1990  7.2422 11.829\n[2,]  7.2422 44.2400 28.650\n[3,] 11.8290 28.6500 37.167\n  Standard Deviations: 4.1471 6.6513 6.0965 \n\ncov2cor(getVarCov(m5))\n\nMarginal variance covariance matrix\n        [,1]    [,2]    [,3]\n[1,] 1.00000 0.26256 0.46788\n[2,] 0.26256 1.00000 0.70654\n[3,] 0.46788 0.70654 1.00000\n  Standard Deviations: 1 1 1 \n\n\n\nanova(m1, m2, m3, m4, m5)\n\n   Model df      AIC      BIC    logLik   Test  L.Ratio p-value\nm1     1  4 3755.240 3772.939 -1873.620                        \nm2     2  4 3774.840 3792.539 -1883.420                        \nm3     3  6 3708.884 3735.433 -1848.442 2 vs 3 69.95528  &lt;.0001\nm4     4  6 3729.156 3755.705 -1858.578                        \nm5     5  8 3675.310 3710.709 -1829.655 4 vs 5 57.84638  &lt;.0001"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2\n\n\n\n2+2\n\n[1] 4"
  }
]